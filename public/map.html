<!DOCTYPE html>
<html>
<title>W3.CSS</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="http://maps.google.com/maps/api/js?sensor=false&libraries=visualization" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.17/proj4.js" ></script>
<script>
    /*---- Menu bar active funtionality -- */
    $(document).ready(function(){
        $("#homelink").click(function(){
            $("#homelink").addClass("w3-black");
            $("#aboutlink").removeClass("w3-black");
            $("#aboutlink").addClass("w3-hover-black");
            $("#paperslink").removeClass("w3-black");
            $("#paperslink").addClass("w3-hover-black");
            $("#visualizationlink").removeClass("w3-black");
            $("#visualizationlink").addClass("w3-hover-black");
        });
        $("#aboutlink").click(function(){
            $("#aboutlink").addClass("w3-black");
            $("#homelink").removeClass("w3-black");
            $("#homelink").addClass("w3-hover-black");
            $("#paperslink").removeClass("w3-black");
            $("#paperslink").addClass("w3-hover-black");
            $("#visualizationlink").removeClass("w3-black");
            $("#visualizationlink").addClass("w3-hover-black");
        });
        $("#paperslink").click(function(){
            $("#paperslink").addClass("w3-black");
            $("#homelink").removeClass("w3-black");
            $("#homelink").addClass("w3-hover-black");
            $("#aboutlink").removeClass("w3-black");
            $("#aboutlink").addClass("w3-hover-black");
            $("#visualizationlink").removeClass("w3-black");
            $("#visualizationlink").addClass("w3-hover-black");
        });
        $("#visualizationlink").click(function(){
            $("#visualizationlink").addClass("w3-black");
            $("#homelink").removeClass("w3-black");
            $("#homelink").addClass("w3-hover-black");
            $("#aboutlink").removeClass("w3-black");
            $("#aboutlink").addClass("w3-hover-black");
            $("#paperslink").removeClass("w3-black");
            $("#paperslink").addClass("w3-hover-black");
        });
    });
</script>
<style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 630px;
        width: 1200px;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #main {margin-left: 120px}
/* Remove margins from "page content" on small screens */
@media only screen and (max-width: 600px) {#main {margin-left: 0}}

#floating-panel {
        position: absolute;
        top: 10px;
        left: 45%;
        z-index: 5;
        background-color:transparent;
        padding: 5px;
        
        text-align: center;
        font-family: 'Roboto','sans-serif';
        line-height: 30px;
        padding-left: 10px;
      }
      #floating-panel {
        background-color:transparent;
        left: 45%;
        padding: 5px;
        position: absolute;
        top: 10px;
        z-index: 5;
      }
    </style>
<style>
body, h1,h2,h3,h4,h5,h6 {font-family: "Montserrat", sans-serif}
.w3-row-padding img {margin-bottom: 12px}
/* Set the width of the sidenav to 120px */
.w3-sidenav {width: 120px;background: #222;}
/* Add a left margin to the "page content" that matches the width of the sidenav (120px) */

/* Remove margins from "page content" on small screens */

</style>
<body class="w3-black">

<!-- Icon Bar (Sidenav - hidden on small screens) -->
<nav class="w3-sidenav w3-center w3-small w3-hide-small">
    <!-- Avatar image in top left corner -->
    <img src="/images/ism.png" style="width:100%">
    <a id="homelink" class="w3-padding-large w3-hover-black" href="index.html">
        <i class="fa fa-home w3-xxlarge"></i>
        <p>HOME</p>
    </a>
    <a id="aboutlink" class="w3-padding-large w3-hover-black" href="#about">
        <i class="fa fa-user w3-xxlarge"></i>
        <p>ABOUT</p>
    </a>
    <a id="paperslink" class="w3-padding-large w3-hover-black" href="#photos">
        <i class="fa fa-envelope w3-xxlarge"></i>
        <p>MY PAPERS</p>
    </a>
    <a id="visualizationlink" class="w3-padding-large w3-black" href="map.html">
        <i class="fa fa-eye w3-xxlarge"></i>
        <p>VISUALIZATION</p>
    </a>
</nav>

<!-- Navbar on small screens (Hidden on medium and large screens) -->
<div class="w3-top w3-hide-large w3-hide-medium" id="myNavbar">
    <ul class="w3-navbar w3-black w3-opacity w3-hover-opacity-off w3-center w3-small">
        <li class="w3-left" style="width:25% !important"><a href="#">HOME</a></li>
        <li class="w3-left" style="width:25% !important"><a href="#about">ABOUT</a></li>
        <li class="w3-left" style="width:25% !important"><a href="#photos">PHOTOS</a></li>
        <li class="w3-left" style="width:25% !important"><a href="#contact">CONTACT</a></li>
    </ul>
</div>

<!-- Page Content -->
<div class="w3-padding-large" id="main">
     <div id="floating-panel">
      <button onclick="toggleHeatmap()" class="w3-btn w3-ripple w3-hover-grey ">Toggle Heatmap</button>
      <button onclick="toogleMarker()" class="w3-btn w3-ripple w3-hover-grey">Toogle Marker</button>
      
    </div>
    <div id="map">
      <script type="text/javascript">
      
  var utm = "+proj=utm +zone=45";
    var wgs84 = "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs";
    //console.log(proj4(utm,wgs84,[534479.73, 2598049.89]));
    
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 12,
      center: new google.maps.LatLng(23.557979, 87.281364),
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      styles: [
            {elementType: 'geometry', stylers: [{color: '#242f3e'}]},
            {elementType: 'labels.text.stroke', stylers: [{color: '#242f3e'}]},
            {elementType: 'labels.text.fill', stylers: [{color: '#746855'}]},
            {
              featureType: 'administrative.locality',
              elementType: 'labels.text.fill',
              stylers: [{color: '#d59563'}]
            },
            {
              featureType: 'poi',
              elementType: 'labels.text.fill',
              stylers: [{color: '#d59563'}]
            },
            {
              featureType: 'poi.park',
              elementType: 'geometry',
              stylers: [{color: '#263c3f'}]
            },
            {
              featureType: 'poi.park',
              elementType: 'labels.text.fill',
              stylers: [{color: '#6b9a76'}]
            },
            {
              featureType: 'road',
              elementType: 'geometry',
              stylers: [{color: '#38414e'}]
            },
            {
              featureType: 'road',
              elementType: 'geometry.stroke',
              stylers: [{color: '#212a37'}]
            },
            {
              featureType: 'road',
              elementType: 'labels.text.fill',
              stylers: [{color: '#9ca5b3'}]
            },
            {
              featureType: 'road.highway',
              elementType: 'geometry',
              stylers: [{color: '#746855'}]
            },
            {
              featureType: 'road.highway',
              elementType: 'geometry.stroke',
              stylers: [{color: '#1f2835'}]
            },
            {
              featureType: 'road.highway',
              elementType: 'labels.text.fill',
              stylers: [{color: '#f3d19c'}]
            },
            {
              featureType: 'transit',
              elementType: 'geometry',
              stylers: [{color: '#2f3948'}]
            },
            {
              featureType: 'transit.station',
              elementType: 'labels.text.fill',
              stylers: [{color: '#d59563'}]
            },
            {
              featureType: 'water',
              elementType: 'geometry',
              stylers: [{color: '#17263c'}]
            },
            {
              featureType: 'water',
              elementType: 'labels.text.fill',
              stylers: [{color: '#515c6d'}]
            },
            {
              featureType: 'water',
              elementType: 'labels.text.stroke',
              stylers: [{color: '#17263c'}]
            }
          ]
    });
   
    var infowindow = new google.maps.InfoWindow();
    var heatmapData =[] , markers =[];
    var marker, i,lat_longi;
    var locations;
$.getJSON("geodata.json", function(json) {
  locations = json;
    //console.log(json); // this will show the info it in firebug console
    for (i = 0; i < locations.length; i++) {
		lat_longi=proj4(utm,wgs84,[locations[i].EASTING, locations[i].NORTHING]);
	//	console.log(lat_longi);
      marker = new google.maps.Marker({
        position: new google.maps.LatLng(lat_longi[1], lat_longi[0]),
        map: map
      });
      markers.push(marker);
      //marker event
      google.maps.event.addListener(marker, 'mouseover', (function(marker, i) {
       return function() {
         infowindow.setContent("<p style='color:black;'>WQI = "+ locations[i].WQI.toString()+"</p>");
         infowindow.open(map, marker);
       }
      })(marker, i));
      google.maps.event.addListener(marker, 'click', (function(marker, i) {
       return function() {
         window.open("/?id="+locations[i].sampno);
       }
      })(marker, i));
      //heat map genarator
      heatmapData.push({location:new google.maps.LatLng(lat_longi[1], lat_longi[0]),weight:locations[i].WQI/100});
     
     
    }
     console.log(heatmapData);
}); 
var gradient = [
          'rgba(0, 255, 255, 0)',
          'rgba(0, 255, 255, 1)',
          'rgba(0, 191, 255, 1)',
          'rgba(0, 127, 255, 1)',
          'rgba(0, 63, 255, 1)',
          'rgba(0, 0, 255, 1)',
          'rgba(0, 0, 223, 1)',
          'rgba(0, 0, 191, 1)',
          'rgba(0, 0, 159, 1)',
          'rgba(0, 0, 127, 1)',
          'rgba(63, 0, 91, 1)',
          'rgba(127, 0, 63, 1)',
          'rgba(191, 0, 31, 1)',
          'rgba(255, 0, 0, 1)'
        ]
        
	var heatmap = new google.maps.visualization.HeatmapLayer({
  data: heatmapData,
  radius: 10
});
heatmap.set('gradient', heatmap.get('gradient') ? null : gradient);
heatmap.setMap(map);

    
	//	console.log("positions----->"+proj4(utm,wgs84,["+locations[i].NORTHING+", "+locations[i].EASTING+"])+" "+locations[i].EASTING +","+ locations[i].NORTHING);
      
	   function toggleHeatmap() {
        heatmap.setMap(heatmap.getMap() ? null : map);
      }
     function toogleMarker() {
       for (var i=0; i< markers.length; i++){
        if (markers[i].getMap() === null) {
            markers[i].setMap(map);
        }
        else {
            markers[i].setMap(null);
        }
      }
      }
  </script>
    </div>
</div>
</body>
</html>